---
title: 【笔记】文件流 学习笔记
categories:
  - Java
date: 2020-02-12 10:34:05
---

## 前言

文件的输入输出流（IO流）学习笔记

<!-- more -->

## java.io包

> File
> InputStream/OutputStream
> FileInputStream/FileOutputStream
> Reader/Writer
> InputStreamReader/OutputStreamWriter
> FileReader/FileWriter
> BufferReader
> PrintStream/PrintWriter

## File

- 封装一个磁盘路径字符串

> 字符串
>> 文件路径
>> 文件夹路径
>> 不存在路径

- 提供对文件或文件夹的一些操作方法

### 创建对象

- 不管文件是否存在，都会新建空文件
- 如果目录不存在，会出异常

#### 一个参数

> `<directory>`：目录名
> `<file>`：文件名

``` java
File file = new File("<directory>/<file>");
```

#### 两个参数

``` java
File file = new File("<directory>", "<file>");
```

### 方法

#### 文件或文件夹属性

##### 获取文件大小

- 获取文件的字节量
- 对目录无效

``` java
length()
```

##### 获取文件名

``` java
getName()
```

##### 获取父目录

``` java
getParent()
```

##### 获取最后修改时间

- 毫秒值

``` java
getLastModified()
```

##### 判断是否是文件

``` java
isFile()
```

##### 判断是否是目录

``` java
isDirectory()
```

##### 判断是否存在

``` java
exists()
```

#### 新建文件

- 如果文件已存在，则不新建，返回false
- 如果父目录不存在，会出现异常

``` java
createNewFile()
```

#### 新建目录

- 创建单层目录

``` java
mkdir()
```

##### 创建多层目录

``` java
mkdirs()
```

#### 删除文件或空目录

- 删除成功返回true，删除失败返回false

``` java
delete()
```

#### 目录列表

- 获得String[]数组，存放文件、目录名

``` java
list()
```

- 获得File[]数组，存放文件、目录的封装对象

``` java
listFiles()
```

- 对文件、不存在的路径、无权进入的目录，列表方法返回null

## 流Stream

- 字节数据的缩写，臭次昂成数据在管道中流动

- 单方向

> 输入流，只能用来读取数据
> 输出流，只能用来输出数据

- 数据只能从头到尾顺序流动一次

### InputStream/OutputStream

- 字节流的抽象父类

#### 输出方法

##### 一个参数

- int的四个字节，只输出末尾的一个字节

``` java
write(int b)
```

##### 三个参数

- 输出数组中，from开始的length个字节

``` java
write(byte[], from, length)
```

###### FileInputStream/FileOutputStream

- 字节流子类
- 文件流，直接插在文件上，直接读写文件数据

#### 输入方法

##### 无参数

- 读取一个字节值，再补三个0字节，转成int，读取结束，再读取，得到-1

``` java
read()
```

###### 习惯格式

``` java
while((int b = file.read()) != -1) {
    ...
}
```

##### 三个参数

- 按数组长度，读取一批字节值，放入数组，并返回这一批的字节数量

``` java
read(byte[] buff)
```

###### 习惯格式

``` java
while((int n = file.read(buff)) != -1) {
    ...
}
```

#### 文件复制

##### 单字节读写

``` java
private static void copy(File from, File to) {
    FileInputStream in = new FileInputStream(from);
    FileOutputStream out = new FileOutputStream(to);
    int b;
    while((b = in.read()) != -1) {
        out.write(b);
    }
}
```

##### 批量数据读写

``` java
private static void copy(File from, File to) {
    FileInputStream in = new FileInputStream(from);
    FileOutputStream out = new FileOutputStream(to);
    byte[] buff = new byte[8192];  // 8k长度的数组
    int n;  // 用来保存一批的数量
    while((n = in.read(buff)) != -1) {
        write(buff, 0, n);
    }    
}
```

## ObjectInputStream/ObjectOutputStream

- 对象的序列化、反序列化

- 把对象的信息，按照固定的字节格式，转成一串字节序列，输出
- 被序列化的对象，必须实现Serializable借口

### 序列化输出对象

``` java
writeObject(Object obj)
```

### 反序列化恢复对象

``` java
readObject(Object obj)
```

### Serializable接口

- 空接口
- 标识接口，标识一个类，可以被序列化

### 不序列化成员

- static

静态属于类，不随对象一起被序列化输出

- transient

只在程序运行期间，在内从中临时存在，不随对象一起被序列化持久保存

### 序列化版本

- 控制旧版本数据，不允许恢复成新版本的类型

``` java
static final long serialVersionUID
```

- 自己不定义，编译器会添加默认版本id

根据类的定义信息，计算产生一个id值

## 字符集、字符编码

### ASC-II

- 范围：0~127
- 英文字符、标点、指令字符

### iso-8859-1（Latin-1）

- 范围：0~255
- 西欧字符

### cjk字符集

- 中国、日本、韩国字符集统称

#### GBK

- 中国国标码
- 双字节编码
- 包含21003个中文字符

### Unicode编码

- 统一码（万国码）
- 有100万以上编码位
- 常用字符表（双字节）
- 生僻字符表（三字节或以上）

#### UTF-8（Unicode Transfermation Format）

- Unicode的传输格式
- 英文（单字节）
- 某些字符（双字节）
- 中文（三字节）
- 特殊符号（四字节）

## Java的字符编码转换

### Unicode转其他编码

- 转成系统默认编码

``` java
getBytes()
```

- 转成指定编码

``` java
getBytes("UTF-8")
```

### 其他编码转Unicode

- 把系统默认的一组字节值，转成Unicode

``` java
new String(byte[])
```

- 把指定编码的一组字节值，转成Unicode

``` java
new String(byte[], "UTF-8")
```

## Reader/Writer

- 字符流的抽象父类

### 方法

#### 一个int参数

- int四个字节中，末尾两个字节是char类型字符数据，只处理末尾两个字节的输出

``` java
write(int c)
```

#### 三个参数

- 输出from开始的length个字符

``` java
write(char[], from, length)
```

#### 一个String参数

- 输出字符串的全部字符

``` java
write(String s)
```

### InputStreamReader/OutputStreamWriter

- 字符编码转换流

#### InputStreamReader

- 读取其他编码转成Unicode

#### OutputStreamWriter

- 把Unicode转成其他编码输出





## 未完待更

03-02-08

## 参考文献

达内教育

